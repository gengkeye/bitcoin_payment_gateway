<section class='landing widgets'>
	<div>
		<h2><strong>Pay with Bitcoin</strong></h2>
		<div>
			<div>
				<div class='columnContainer'>
					<%= form_tag payments_path, method: :post, remote: true, format: 'js',  authenticity_token: true, id: 'btc_form' do %>
					  <%= hidden_field_tag :uid, params[:uid] %>
					  <p><input type="text" name="amount" placeholder="BTC" id="amount_input"></p>
					  <button type="button" class="button_pay">Pay</button>
					<% end %>
				</div>
			</div>
		</div>
	</div>
</section>
<footer class='dark loaderReveal loaderRevealDelay1000 loaderRevealSpeed600'>
	<div class='copyright'> A product of skyluster &copy; 2017</div>	
</footer>
<%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
<%= stylesheet_link_tag    'jquery.countdown', media: 'all', 'data-turbolinks-track' => true %>

<script>
	$('.button_pay').click(function(){
		var amount = parseFloat($('#amount_input').val());
		if(/^[+-]?\d+(\.\d+)?$/.test(amount)){
			$('#btc_form').submit();
		}else{
			alert("Please insert correct amount.")
		}
	})
	function start_to_countdown(){
	  var num = Date.now() + 15*60*1000;
	  var target_time = new Date(num);
	  $('#defaultCountdown').countdown({until: target_time, compact: true, description: '', format: 'HMS'});
	}

	$("#cancel_order").click(function(){
	   $.ajax({
	      url: "<%= payment_path(id: @order&.id || 1 ) %>",
	      type: 'patch',
	      data: { uid: "<%= params[:uid] %>"},
	      dataType: 'jsonp'
	   })
	})
</script>
